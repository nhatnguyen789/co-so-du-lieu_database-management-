CREATE DATABASE DEANCONGTY

DROP DATABASE DEANCONGTY
--DROP TABLE NHANVIEN
--DROP TABLE PHONGBAN
--DROP TABLE DIADIEM_PHG
--DROP TABLE DEAN
--DROP TABLE PHANCONG
--DROP TABLE THANNHAN
USE DEANCONGTY

CREATE TABLE NHANVIEN
(HONV CHAR(15) not null,
TENLOT CHAR(15) not null,
TENNV CHAR(15) not null, 
MANV CHAR(4) PRIMARY KEY,
NGSINH datetime,
DCHI CHAR(30), 
PHAI CHAR(3) CONSTRAINT NV_PHAI_CHK CHECK (PHAI IN('NAM','NU')),
LUONG INT CONSTRAINT NV_LUONG_DF DEFAULT(1000),
MA_NQL CHAR(4),
PHG CHAR(2))

CREATE TABLE DEAN
(TENDA CHAR(15) NOT NULL,
MADA INT PRIMARY KEY,
DDIEM_DA CHAR(15),
PHONG CHAR(2),
NGAYBD DATETIME,
NGAYKT DATETIME)

CREATE TABLE DIADIEM_PHG
(MAPHG CHAR(2),
DIADIEM CHAR(15),
PRIMARY KEY(MAPHG,DIADIEM))

CREATE TABLE PHONGBAN
(TENPHG CHAR(15) NOT NULL,
MAPHG CHAR(2) PRIMARY KEY,
TRPHG CHAR(4),
NG_NHANCHUC DATETIME)

CREATE TABLE THANNHAN
(MA_NVIEN CHAR(4),
TENTN CHAR(15),
PHAI CHAR(3) CONSTRAINT TN_PHAI_CK CHECK(PHAI IN('NAM','NU')),
NGSINH DATETIME,
QUANHE CHAR(8),
PRIMARY KEY(MA_NVIEN,TENTN))

CREATE TABLE PHANCONG
(MA_NVIEN CHAR(4),
SODA INT,
THOIGIAN FLOAT(5),
PRIMARY KEY(MA_NVIEN,SODA))

ALTER TABLE PHONGBAN ADD CONSTRAINT FK_PHONGBAN_NHANVIEN FOREIGN KEY(TRPHG) REFERENCES NHANVIEN(MANV)
ALTER TABLE DIADIEM_PHG ADD CONSTRAINT FK_DIADIEM_PHG_PHONGBAN FOREIGN KEY (MAPHG) REFERENCES PHONGBAN(MAPHG)
ALTER TABLE PHANCONG ADD CONSTRAINT FK_PHANCONG_NHANVIEN FOREIGN KEY(MA_NVIEN) REFERENCES NHANVIEN(MANV)
ALTER TABLE PHANCONG ADD CONSTRAINT FK_PHANCONG_DEAN FOREIGN KEY(SODA) REFERENCES DEAN(MADA)
ALTER TABLE THANNHAN ADD CONSTRAINT FK_THANNHAN_NHANVIEN FOREIGN KEY(MA_NVIEN) REFERENCES NHANVIEN(MANV)
ALTER TABLE DEAN ADD CONSTRAINT FK_DEAN_PHONGBAN FOREIGN KEY(PHONG) REFERENCES PHONGBAN(MAPHG)

ALTER TABLE NHANVIEN ADD CONSTRAINT FK_NHANVIEN_PHONGBAN FOREIGN KEY (PHG) REFERENCES PHONGBAN(MAPHG)
ALTER TABLE NHANVIEN ADD CONSTRAINT FK_NHANVIEN_NQL FOREIGN KEY (MA_NQL) REFERENCES NHANVIEN(MANV)


insert into NHANVIEN values ('TRAN','THANH','TIEN','1111',1969/07/02,'890 BUI THI XUAN Q1 TPHCM','NAM',300,'2222','NC')
insert into NHANVIEN values ('NGUYEN','THANH','NAM','2222',1965/08/01,'78 NGUYEN TRAI Q1 TPHCM','NAM',400,'8888','NC')
insert into NHANVIEN values ('LE','THANH','NGOC','3333',1970/09/12,'456 TRAN BINH TRONG Q5 TPHCM','NU',250,'4444','DH')
insert into NHANVIEN values ('TRAN','QUYNH','ANH','4444',1960/17/04,'132 BACH DANG QPN TPHCM','NU',430,'8888','DH')
insert into NHANVIEN values ('NGUYEN','ANH','KHOA','5555',1962/25/06,'67 TRAN PHU NHA TRANG','NAM',380,'2222','NC')
insert into NHANVIEN values ('TRAN','NGOC','LINH','6666',1975/12/08,'789 HUNG VUONG Q6 TPHCM','NU',250,'2222','NC')
insert into NHANVIEN values ('BUI','THANH','PHONG','7777',1969/28/10,'689 LY THUONG KIET TPHCM','NAM',250,'4444','DH')
insert into NHANVIEN values ('PHAM','VAN','HUNG','8888',1950/13/09,'67 BA TRIEU HA NOI','NAM',550,'','QL')
select *
from NHANVIEN

insert into THANNHAN values ('2222','MAI','NU',1986/05/04,'CON GAI')
insert into THANNHAN values ('2222','TUAN','NAM',1983/25/10,'CON TRAI')
insert into THANNHAN values ('2222','LINH','NU',1955/03/05,'VO CHONG')
insert into THANNHAN values ('4444','MINH','NAM',1952/28/02,'VO CHONG')
insert into THANNHAN values ('1111','DAT','NAM',1990/01/01,'CON TRAI')
insert into THANNHAN values ('1111','NGOC','NU',1995/30/12,'CON GAI')
insert into THANNHAN values ('1111','PHUONG','NU',1970/05/05,'VO CHONG')
select *
from THANNHAN

insert into PHONGBAN values ('QUAN LY','QL','8888',1981/05/06)
insert into PHONGBAN values ('DIEU HANH ','DH','7777',1995/11/01)
insert into PHONGBAN values ('NGHIEN CUU','NC','2222',1988/26/08)
select *
from PHONGBAN

insert into DIADIEM_PHG values ('QL','TP HCM')
insert into DIADIEM_PHG values ('DH','HA NOI')
insert into DIADIEM_PHG values ('DH','TP HCM')
insert into DIADIEM_PHG values ('NC','NHA TRANG')
insert into DIADIEM_PHG values ('NC','DA NANG')
insert into DIADIEM_PHG values ('NC','TP HCM')
select *
from DIADIEM_PHG

insert into DEAN values ('TIN HOC HOA 1','1','TP HCM','NC',2007/05/04,2008/23/08)
insert into DEAN values ('TIN HOC HOA 2','2','HA NOI','NC',2008/10/10,2008/30/12)
insert into DEAN values ('DAO TAO 1','10','NHA TRANG','DH',2005/05/05,2006/20/08)
insert into DEAN values ('DAO TAO 2','20','DA NANG','DH',2007/30/04,2008/19/09)
select *
from DEAN

insert into PHANCONG values ('1111','1',32.5)
insert into PHANCONG values ('1111','2',7.5)
insert into PHANCONG values ('6666','1',20.0)
insert into PHANCONG values ('6666','2',20.0)
insert into PHANCONG values ('2222','2',10.0)
insert into PHANCONG values ('2222','10',10.0)
insert into PHANCONG values ('2222','20',10.0)
insert into PHANCONG values ('3333','10',10.0)
insert into PHANCONG values ('7777','10',35.0)
insert into PHANCONG values ('7777','20',15.0)
insert into PHANCONG values ('8888','20',20.0)
select *
from PHANCONG